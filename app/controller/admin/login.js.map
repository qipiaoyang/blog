{
    "version": 3,
    "sources": [
        "..\\..\\..\\src\\controller\\admin\\login.js"
    ],
    "names": [
        "module",
        "exports",
        "think",
        "Controller",
        "indexAction",
        "display",
        "loginAction",
        "is_login",
        "islogin",
        "isAjax",
        "username",
        "post",
        "password",
        "userform",
        "model",
        "data",
        "where",
        "user",
        "find",
        "isEmpty",
        "session",
        "json",
        "name",
        "url",
        "errno",
        "fail",
        "redirect",
        "render",
        "geetestAction",
        "geetest",
        "isPost",
        "console",
        "log",
        "res",
        "validate",
        "ctx",
        "register",
        "logoutAction"
    ],
    "mappings": ";;AAAAA,OAAOC,OAAP,GAAiB,cAAcC,MAAMC,UAApB,CAA+B;AAC5CC,kBAAc;AACV,eAAO,KAAKC,OAAL,EAAP;AACH;AACKC,eAAN,GAAoB;AAAA;;AAAA;AAChB,kBAAKC,QAAL,GAAgB,MAAM,MAAKC,OAAL,EAAtB;AACA,gBAAG,MAAKC,MAAL,EAAH,EAAiB;AACb;AACA,oBAAIC,WAAW,MAAKC,IAAL,CAAU,UAAV,CAAf;AACA,oBAAIC,WAAW,MAAKD,IAAL,CAAU,UAAV,CAAf;AACA,oBAAIE,WAAW,MAAKC,KAAL,CAAW,YAAX,CAAf;AACA,oBAAIC,OAAO,MAAMF,SAASG,KAAT,CAAe,EAACC,MAAKP,QAAN,EAAeE,UAASA,QAAxB,EAAf,EAAkDM,IAAlD,EAAjB;AACA,oBAAG,CAAChB,MAAMiB,OAAN,CAAcJ,IAAd,CAAJ,EAAwB;AACpB,0BAAKK,OAAL,CAAa,UAAb,EAAwBL,IAAxB;AACA,2BAAO,MAAKM,IAAL,CAAU;AACbC,8BAAK,MADQ;AAEbC,6BAAI,oBAFS;AAGbC,+BAAM;AAHO,qBAAV,CAAP;AAKH,iBAPD,MAOO;AACH,2BAAO,MAAKC,IAAL,CAAU,GAAV,EAAc,cAAd,CAAP;AACH;AACJ,aAhBD,MAgBO;AACH,oBAAGlB,QAAH,EAAa;AACT,2BAAO,MAAKmB,QAAL,CAAc,cAAd,CAAP;AACH,iBAFD,MAEO;AACH;AACA,0BAAKC,MAAL,CAAY,oBAAZ;AACA,2BAAO,MAAKtB,OAAL,EAAP;AACH;AACJ;AA1Be;AA6BnB;AACKuB,iBAAN,GAAsB;AAAA;;AAAA;AAClB,kBAAMC,UAAU,OAAKf,KAAL,CAAW,SAAX,CAAhB,CADkB,CACqB;AACvC,gBAAI,OAAKgB,MAAT,EAAiB;AACb,sBAAMnB,OAAO,OAAKA,IAAL,EAAb;AACAoB,wBAAQC,GAAR,CAAYrB,IAAZ;AACA,sBAAMsB,MAAM,MAAMJ,QAAQK,QAAR,CAAiB,OAAKC,GAAtB,EAA2BxB,IAA3B,CAAlB;AACA,uBAAO,OAAKU,IAAL,CAAUY,GAAV,CAAP;AACH,aALD,MAKO;AACH,sBAAMA,MAAM,MAAMJ,QAAQO,QAAR,CAAiB,OAAKD,GAAtB,CAAlB;AACA;AACA,uBAAO,OAAKd,IAAL,CAAUY,GAAV,CAAP;AACH;AAXiB;AAYrB;;AAGD;AACMI,gBAAN,GAAqB;AAAA;;AAAA;AACjB,kBAAM,OAAKjB,OAAL,CAAa,IAAb,CAAN;AACA,mBAAO,OAAKM,QAAL,CAAc,cAAd,CAAP,CAFiB,CAEoB;AAFpB;AAGpB;;AAED;AACMlB,WAAN,GAAgB;AAAA;;AAAA;AACZ;AACA,kBAAMS,OAAO,MAAM,OAAKG,OAAL,CAAa,UAAb,CAAnB;AACA,kBAAMa,MAAM/B,MAAMiB,OAAN,CAAcF,IAAd,IAAsB,KAAtB,GAA8B,IAA1C;AACA,mBAAOgB,GAAP;AAJY;AAKf;AA7D2C,CAAhD",
    "file": "..\\..\\..\\src\\controller\\admin\\login.js",
    "sourcesContent": [
        "module.exports = class extends think.Controller {\n    indexAction() {\n        return this.display();\n    }\n    async loginAction() {\n        this.is_login = await this.islogin();\n        if(this.isAjax()){\n            //获取登陆的账号密码\n            let username = this.post('username');\n            let password = this.post('password');\n            let userform = this.model('think_user');\n            let data = await userform.where({user:username,password:password}).find();\n            if(!think.isEmpty(data)){\n                this.session('userinfo',data);\n                return this.json({\n                    name:'后台首页',\n                    url:'/admin/index/index',\n                    errno:0\n                });\n            } else {\n                return this.fail(403,'账号密码错误，请重新填写');\n            }\n        } else {\n            if(is_login) {\n                return this.redirect('/admin/index');\n            } else {\n                // await\n                this.render('/admin/login/login');\n                return this.display();\n            }\n        }\n\n\n    }\n    async geetestAction() {\n        const geetest = this.model('geetest'); // 加载 commoon 模块下的 geetset service\n        if (this.isPost) {\n            const post = this.post();\n            console.log(post);\n            const res = await geetest.validate(this.ctx, post);\n            return this.json(res);\n        } else {\n            const res = await geetest.register(this.ctx);\n            // console.log(res);\n            return this.json(res);\n        }\n    }\n\n\n    //注销登陆界面\n    async logoutAction() {\n        await this.session(null);\n        return this.redirect('/admin/login');//登录成功将用户信息写入session，返回到user首页\n    }\n\n    //判断是否登陆\n    async islogin() {\n        // 前台判断是否登录\n        const user = await this.session('userinfo');\n        const res = think.isEmpty(user) ? false : true;\n        return res;\n    }\n};"
    ]
}